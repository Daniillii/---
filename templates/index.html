{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞{% endblock %}

{% block content %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div class="card" style="border-left: 4px solid #667eea;">
        <h3 style="color: #667eea; margin-bottom: 10px;">üíµ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ "%.2f"|format(stats.total_revenue) }} ‚ÇΩ</p>
    </div>
    
    <div class="card" style="border-left: 4px solid #28a745;">
        <h3 style="color: #28a745; margin-bottom: 10px;">üìà –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ "%.2f"|format(stats.total_profit) }} ‚ÇΩ</p>
    </div>
    
    <div class="card" style="border-left: 4px solid #ffc107;">
        <h3 style="color: #ffc107; margin-bottom: 10px;">üìä –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∞</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ "%.2f"|format(stats.avg_margin) }}%</p>
    </div>
    
    <div class="card" style="border-left: 4px solid #17a2b8;">
        <h3 style="color: #17a2b8; margin-bottom: 10px;">üìù –ó–∞–ø–∏—Å–µ–π</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ stats.data_points }}</p>
    </div>
</div>

<div class="card">
    <h2 style="margin-bottom: 20px;">üìã –ò—Å—Ç–æ—Ä–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h2>
    
    {% if all_data %}
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="background: #f8f9fa; border-bottom: 2px solid #ddd;">
                <th style="padding: 10px; text-align: left;">–ú–µ—Å—è—Ü/–ì–æ–¥</th>
                <th style="padding: 10px; text-align: right;">–í—ã—Ä—É—á–∫–∞</th>
                <th style="padding: 10px; text-align: right;">–ü–æ—Å—Ç. –∏–∑–¥–µ—Ä–∂–∫–∏</th>
                <th style="padding: 10px; text-align: right;">–ü–µ—Ä. –∏–∑–¥–µ—Ä–∂–∫–∏</th>
                <th style="padding: 10px; text-align: right;">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</th>
                <th style="padding: 10px; text-align: center;">–ú–∞—Ä–∂–∞</th>
            </tr>
        </thead>
        <tbody>
            {% for data in all_data %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 10px;">{{ data.month }}/{{ data.year }}</td>
                <td style="padding: 10px; text-align: right;">{{ "%.2f"|format(data.revenue) }} ‚ÇΩ</td>
                <td style="padding: 10px; text-align: right;">{{ "%.2f"|format(data.fixed_costs) }} ‚ÇΩ</td>
                <td style="padding: 10px; text-align: right;">{{ "%.2f"|format(data.variable_costs or 0) }} ‚ÇΩ</td>
                <td style="padding: 10px; text-align: right; font-weight: bold; color: {% if data.net_profit > 0 %}#28a745{% else %}#dc3545{% endif %};">
                    {{ "%.2f"|format(data.net_profit or 0) }} ‚ÇΩ
                </td>
                <td style="padding: 10px; text-align: center;">{{ "%.2f"|format(data.profit_margin or 0) }}%</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="text-align: center; color: #999; padding: 30px;">üì≠ –î–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. <a href="/form" style="color: #667eea;">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–ø–∏—Å—å</a></p>
    {% endif %}
</div>

<div style="text-align: center; margin-top: 30px;">
    <a href="/form" class="btn" style="font-size: 16px; padding: 15px 30px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</a>
</div>
{% endblock %}